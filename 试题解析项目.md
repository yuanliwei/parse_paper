# 前提
1. 目前不用考虑公式，公式暂时用占位符替代.
2. 经过对比发现word原文档的试题结构跟转为html再转为txt后的试题结构相差不大，所以解析引擎使用从word转换来的纯文本做输入，日后需要样式的话可以反向映射到html的样式上。
3. C# 自带有API方法可以把.docx文档转换到html。缺点是对序号支持不太好，而且不支持公式，但是可以找到公式对应的文件。现在我已经写了一个简单的命令行程序用来把.docx转为.html，同时在转换的时候把公式的文件名放在公式的位置做占位符。
4. 关于.doc文档转到.docx文档.个人用户可以用新版的office另存为.docx文件，对于大量文档的转换微软提供了一个OMPM（2007 Microsoft Office System Migration Guidance: [Microsoft Office Migration Planning Manager](
https://www.microsoft.com/en-us/download/details.aspx?id=21888)
5. 所以目前的解析引擎实质上是在解析纯文本的试题结构

# 试题解析的思路
1. 首先规定一些关键字、词。
2. 然后使用这些关键词 加上 空格符 换行符 把全部内容打散。
3. 之后使用合并方法，合并出一些有意义的小单元，每个小单元有相应的类型
4. 在之后的操作就跟原始的文本没关系了，简单的说就是根据模型把一些小单元合并成大些的单元，再用这些大些的单元合成每道小题。
5. 合并有错误的话可以把选中的单元重新打散，然后再手动合并（这个功能还不完善）
6. 后面还考虑有直接编辑的功能。
7. 每道题和组成单元之间有对应关系，在组题部分可以发现错误，然后能够查找到组成单元部分再使用其它分割合并规则重新解析有问题的部分。

# 引擎程序
1. 引擎编程语言使用的是coffeescript，编译结果是js，现在可以直接在浏览器里查看。
2. 程序结构
    - 引擎目前分为三个模块，拆分模块、合并Element模块、合并Question模块
    - 界面上左边显示结果，右边是一个简单的按钮面板。
    - 其中左边显示的有三个表格，分别是
        - 分割关键字 + 简单合并后的结果
        - 合并Element的结果
        - 合并完的每道题

# 结果
  1. 样题中的单选题全都可以正常解析，部分解答题可以正常解析
  2. 第9题解析有问题 现在可以通过手动合并可以正常解析
  3. 第10题没有“解析”关键字后面进行单独处理
  4. 在CPU3.3GHz的台式机上，测试了1000道单选题，去掉输出占用的时间结果如下：
      - 对于样题中的单选题用时 7502毫秒
      - 对于只有题干选项的简化版单选题用时 2302毫秒